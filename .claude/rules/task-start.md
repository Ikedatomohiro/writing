# Task Start Rules

## タスク開始前の必須確認

新しいタスクを開始する際は、必ず以下の手順を実行すること。

### 1. mainブランチを最新にする

worktree作成前に、必ずmainブランチを最新の状態にする。

```bash
git checkout main
git pull origin main
```

### 2. worktreeを作成してブランチを作成

`/using-git-worktrees` スキルを使用してworktreeを作成する。

```
/using-git-worktrees
```

これにより以下が自動化される:
- mainブランチを起点とした新しいブランチの作成
- `.worktrees/` ディレクトリへのworktree配置
- 環境変数ファイルのコピー
- 依存関係のインストール
- ベースラインテストの実行

**ブランチ命名規則**:
- `feature/機能名` - 新機能
- `fix/バグ名` - バグ修正
- `refactor/対象` - リファクタリング
- `docs/対象` - ドキュメント

### 3. 環境変数の確認（追加設定が必要な場合）

タスクに必要な環境変数を確認し、不足があればユーザーに尋ねる。

**確認事項**:
- [ ] `.env.example` または `.env.local.example` の存在確認
- [ ] 必要なAPIキーや認証情報
- [ ] 外部サービスへの接続情報

**不足時の対応**:
- 必要な環境変数名と用途をユーザーに質問する
- 機密情報は絶対にコードにハードコードしない

### 4. 必要なプログラムの存在確認

mainブランチにタスク開始に必要なプログラムやモジュールが存在することを確認する。

**確認事項**:
- [ ] 依存するモジュールやコンポーネントが存在するか
- [ ] 必要なAPIエンドポイントが実装されているか
- [ ] 必要な型定義やインターフェースが存在するか
- [ ] テスト用のユーティリティが揃っているか

### 5. 不足時のPR確認

必要なプログラムがmainに存在しない場合:

1. GitHub PRを確認する
   ```bash
   gh pr list --state open
   ```

2. 対象のタスクに関連するPRがあるか検索する
   ```bash
   gh pr list --search "キーワード"
   ```

3. 関連PRが見つかった場合:
   - ユーザーに該当PRの確認を依頼する
   - PRの内容を報告し、マージ待ちかレビュー待ちかを伝える

4. 関連PRがない場合:
   - 不足しているプログラムの実装が先に必要であることを報告する
   - 依存関係を明確にしてユーザーに判断を仰ぐ

## タスク完了時

タスクが完了したら `/push` コマンドを使用してPRを作成する。

```
/push
```

**PRには以下を含める**:
- 変更内容のサマリー
- テスト計画
- 関連するissueやタスクへのリンク（あれば）

## チェックリスト

### タスク開始前

- [ ] mainブランチを最新にしたか
- [ ] `/using-git-worktrees` でworktreeを作成したか
- [ ] 必要な環境変数を確認したか
- [ ] 依存プログラムがmainに存在するか
- [ ] 不足があればPRを確認したか

### タスク完了時

- [ ] すべてのテストが通っているか
- [ ] コーディングスタイルに従っているか
- [ ] `/push` でPRを作成したか
