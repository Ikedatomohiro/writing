---
name: pr-review
description: PRのコードレビューを実行する。spec.mdとの整合性、セキュリティ、コード品質、ディレクトリ構成を検証する。ユーザーが「/pr-review」や「PRレビューして」と言った時に使用する。
---

# PR Review

PRの変更内容を多角的にレビューする。

## レビュー手順

### 1. 変更内容の把握

```bash
# 変更ファイル一覧
git diff --name-only origin/main...HEAD

# 変更差分
git diff origin/main...HEAD
```

### 2. spec.mdとの整合性確認

対象機能のspec.mdが存在する場合、以下を確認:

- [ ] すべての要件が実装されているか
- [ ] 仕様と異なる挙動がないか
- [ ] 不足している機能がないか

spec.mdが見つからない場合はスキップし、その旨を報告する。

### 3. セキュリティレビュー

`.claude/rules/security.md`の観点で確認:

- [ ] シークレットのハードコードがないか
- [ ] 入力バリデーションが適切か
- [ ] SQLインジェクション/XSS対策
- [ ] エラーメッセージに機密情報が含まれないか

詳細: [references/security-checklist.md](references/security-checklist.md)

### 4. コード品質レビュー

- [ ] 冗長な記述がないか（重複コード、不要な処理）
- [ ] 関数は適切なサイズか（50行以下推奨）
- [ ] 命名は明確か
- [ ] コメントは必要十分か

### 5. 構造レビュー

**上下関係（階層構造）**:
- [ ] ディレクトリ配置は機能ドメインに沿っているか
- [ ] 依存関係の方向は適切か（上位→下位のみ）
- [ ] 循環参照がないか

**並列関係（同階層の整合性）**:
- [ ] 同階層のモジュールは同じ抽象度か
- [ ] 命名規則が統一されているか
- [ ] 責務の分離が明確か

詳細: [references/structure-checklist.md](references/structure-checklist.md)

## 出力フォーマット

```markdown
## PR Review: [機能名]

### 概要
[変更内容の要約]

### spec.md整合性
- 結果: OK / NG / N/A
- 詳細: [具体的な指摘]

### セキュリティ
- 結果: OK / 要確認
- 詳細: [具体的な指摘]

### コード品質
- 結果: OK / 改善推奨
- 詳細: [具体的な指摘]

### 構造
- 結果: OK / 改善推奨
- 詳細: [具体的な指摘]

### 総合判定
- [ ] Approve
- [ ] Request Changes
```
